"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6398],{6762:function(e,t,n){var r=n(6747),i=n(9619),o=n(7556),s=n(7051),a=n(3382),l=n(1733),u=n(4711),h=n(4142),c=n(6117),p=n(9775),x=n(677),d=n(3814),_=n(1625);const g="extentchanged";class v extends r.ZP{constructor(e){super(g),this.extent=e}}class w extends a.Z{constructor(e){super(e=e||{}),this.on,this.once,this.un,this.condition_=e.condition?e.condition:h.Bx,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new l.Z({source:new u.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:E(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new l.Z({source:new u.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:I(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}snapToVertex_(e,t){const n=t.getCoordinateFromPixelInternal(e),r=function(e,t){return(0,p.Bs)(n,e)-(0,p.Bs)(n,t)},i=this.getExtentInternal();if(i){const o=function(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(i);o.sort(r);const s=o[0];let a=(0,p.oL)(n,s);const l=t.getPixelFromCoordinateInternal(a);if((0,p.TE)(e,l)<=this.pixelTolerance_){const e=t.getPixelFromCoordinateInternal(s[0]),n=t.getPixelFromCoordinateInternal(s[1]),r=(0,p.bI)(l,e),i=(0,p.bI)(l,n),o=Math.sqrt(Math.min(r,i));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(a=r>i?s[1]:s[0]),a}}return null}handlePointerMove_(e){const t=e.pixel,n=e.map;let r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(r)}createOrUpdateExtentFeature_(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,d.oJ)(e)):t.setGeometry(void 0):(t=e?new i.Z((0,d.oJ)(e)):new i.Z({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}createOrUpdatePointerFeature_(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new i.Z(new s.Z(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t}handleEvent(e){return!e.originalEvent||!this.condition_(e)||(e.type!=o.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),super.handleEvent(e),!1)}handleDownEvent(e){const t=e.pixel,n=e.map,r=this.getExtentInternal();let i=this.snapToVertex_(t,n);const o=function(e){let t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(i&&r){const e=i[0]==r[0]||i[0]==r[2]?i[0]:null,t=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==e&&null!==t?this.pointerHandler_=f(o(i)):null!==e?this.pointerHandler_=y(o([e,r[1]]),o([e,r[3]])):null!==t&&(this.pointerHandler_=y(o([r[0],t]),o([r[2],t])))}else i=n.getCoordinateFromPixelInternal(t),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=f(i);return!0}handleDragEvent(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}}handleUpEvent(e){this.pointerHandler_=null;const t=this.getExtentInternal();return t&&0!==(0,c.bg)(t)||this.setExtent(null),!1}setMap(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),super.setMap(e)}getExtent(){return(0,_.Fj)(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new v(this.extent_))}}function E(){const e=(0,x.Ly)();return function(t,n){return e.Polygon}}function I(){const e=(0,x.Ly)();return function(t,n){return e.Point}}function f(e){return function(t){return(0,c.hI)([e,t])}}function y(e,t){return e[0]==t[0]?function(n){return(0,c.hI)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,c.hI)([e,[t[0],n[1]]])}:null}var F=w,P=n(1055),m=n(5117),Z=n(2893),O=n(824);const T=new P.Z({layers:[new Z.Z({source:new m.Z})],target:"map",view:new O.ZP({center:[0,0],zoom:2})}),M=new F({condition:h.vY});T.addInteraction(M)}},function(e){var t;t=6762,e(e.s=t)}]);
//# sourceMappingURL=extent-interaction.js.map